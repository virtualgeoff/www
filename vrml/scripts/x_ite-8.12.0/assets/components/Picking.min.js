/* X_ITE v8.12.0 */(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Components");var i=e.n(t);const n=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Fields");var s=e.n(n);const o=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Base/X3DFieldDefinition");var r=e.n(o);const a=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Base/FieldDefinitionArray");var c=e.n(a);const h=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Components/Core/X3DSensorNode");var p=e.n(h);const l=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Rendering/TraverseType");var d=e.n(l);const g=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Base/X3DConstants");var u=e.n(g);const m=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Namespace");var y=e.n(m);let _=0;const w={MATCH_ANY:_++,MATCH_EVERY:_++,MATCH_ONLY_ONE:_++};y().add("MatchCriterion","x_ite/Browser/Picking/MatchCriterion",w);const k=w;let S=0;const b={BOUNDS:S++,GEOMETRY:S++};y().add("IntersectionType","x_ite/Browser/Picking/IntersectionType",b);const f=b;let v=0;const O={ANY:v++,CLOSEST:v++,ALL:v++,ALL_SORTED:v++};y().add("SortOrder","x_ite/Browser/Picking/SortOrder",O);const T=O,N=window[Symbol.for("X_ITE.X3D-8.12.0")].require("standard/Math/Numbers/Matrix4");var C=e.n(N);function P(e,t){this.array=e,t&&(this.compare=t)}Object.assign(P.prototype,{compare:(e,t)=>e<t,sort(e,t){t-e>1&&this.quicksort(e,t-1)},quicksort(e,t){let i=e,n=t;const{array:s,compare:o}=this,r=s[e+t>>>1];for(;;){for(;o(s[i],r);)++i;for(;o(r,s[n]);)--n;if(!(i<n)){i===n&&(++i,--n);break}{const e=s[i];s[i]=s[n],s[n]=e,i++,n--}}e<n&&this.quicksort(e,n),i<t&&this.quicksort(i,t)}});const G=P;y().add("QuickSort","standard/Math/Algorithms/QuickSort",G);const M=G,x=window[Symbol.for("X_ITE.X3D-8.12.0")].require("standard/Utility/ObjectCache");var B,j,A,D=e.n(x)()(C());function F(e,t){return e.distance<t.distance}function E(e){p().call(this,e),this.addType(u().X3DPickSensorNode),this.objectType=new Set,this.intersectionType=f.BOUNDS,this.sortOrder=T.CLOSEST,this.pickTargetNodes=new Set,this.modelMatrices=[],this.targets=[],this.targets.size=0,this.pickedTargets=[],this.pickedTargetsSorter=new M(this.pickedTargets,F),this.pickedGeometries=new(s().MFNode)}Object.assign(Object.setPrototypeOf(E.prototype,p().prototype),{initialize(){this.getLive().addInterest("set_live__",this),this._enabled.addInterest("set_live__",this),this._objectType.addInterest("set_objectType__",this),this._matchCriterion.addInterest("set_matchCriterion__",this),this._intersectionType.addInterest("set_intersectionType__",this),this._sortOrder.addInterest("set_sortOrder__",this),this._pickTarget.addInterest("set_pickTarget__",this),this.set_objectType__(),this.set_matchCriterion__(),this.set_intersectionType__(),this.set_sortOrder__(),this.set_pickTarget__()},getObjectType(){return this.objectType},getMatchCriterion(){return this.matchCriterion},getIntersectionType(){return this.intersectionType},getSortOrder(){return this.sortOrder},getModelMatrices(){return this.modelMatrices},getTargets(){return this.targets},getPickShape:(()=>{const e=new WeakMap;return function(t){const i=e.get(t);if(void 0!==i)return i;const n=this.getBrowser(),s=n.getPrivateScene().createNode("Shape",!1),o=n.getPrivateScene().createNode("CollidableShape",!1);return s.setPrivate(!0),o.setPrivate(!0),o.setConvex(!0),s._geometry=t,o._shape=s,s.setup(),o.setup(),e.set(t,o),o}})(),getPickedGeometries:function(){var e=this.targets,t=e.size,i=this.pickedTargets,n=this.pickedGeometries;i.length=0;for(var s=0;s<t;++s){var o=e[s];o.intersected&&i.push(o)}if(0===i.length)return n.length=0,n;switch(this.sortOrder){case T.ANY:i.length=1,n[0]=this.getPickedGeometry(i[0]),n.length=1;break;case T.CLOSEST:this.pickedTargetsSorter.sort(0,i.length),i.length=1,n[0]=this.getPickedGeometry(i[0]),n.length=1;break;case T.ALL:s=0;for(var r=i.length;s<r;++s)n[s]=this.getPickedGeometry(i[s]);n.length=r;break;case T.ALL_SORTED:for(this.pickedTargetsSorter.sort(0,i.length),s=0,r=i.length;s<r;++s)n[s]=this.getPickedGeometry(i[s]);n.length=r}return n},getPickedGeometry(e){var t=this.getExecutionContext(),i=e.geometryNode;if(i.getExecutionContext()===t)return i;if((o=i.getExecutionContext()).getType().includes(u().X3DPrototypeInstance)&&o.getExecutionContext()===t)return o;for(var n=e.pickingHierarchy,s=n.length-1;s>=0;--s){var o,r=n[s];if(r.getExecutionContext()===t)return r;if((o=r.getExecutionContext()).getType().includes(u().X3DPrototypeInstance)&&o.getExecutionContext()===t)return o}return null},getPickedTargets(){return this.pickedTargets},set_live__(){this.getLive().getValue()&&this._enabled.getValue()&&!this.objectType.has("NONE")?(this.getBrowser().addPickSensor(this),this.setPickableObject(!0)):(this.getBrowser().removePickSensor(this),this.setPickableObject(!1))},set_objectType__(){this.objectType.clear();for(var e=0,t=this._objectType.length;e<t;++e)this.objectType.add(this._objectType[e]);this.set_live__()},set_matchCriterion__:(A=new Map([["MATCH_ANY",k.MATCH_ANY],["MATCH_EVERY",k.MATCH_EVERY],["MATCH_ONLY_ONE",k.MATCH_ONLY_ONE]]),function(){this.matchCriterion=A.get(this._matchCriterion.getValue()),void 0===this.matchCriterion&&(this.matchCriterion=MatchCriterionType.MATCH_ANY)}),set_intersectionType__:(j=new Map([["BOUNDS",f.BOUNDS],["GEOMETRY",f.GEOMETRY]]),function(){this.intersectionType=j.get(this._intersectionType.getValue()),void 0===this.intersectionType&&(this.intersectionType=f.BOUNDS)}),set_sortOrder__:(B=new Map([["ANY",T.ANY],["CLOSEST",T.CLOSEST],["ALL",T.ALL],["ALL_SORTED",T.ALL_SORTED]]),function(){this.sortOrder=B.get(this._sortOrder.getValue()),void 0===this.sortOrder&&(this.sortOrder=T.CLOSEST)}),set_pickTarget__(){this.pickTargetNodes.clear();for(var e=0,t=this._pickTarget.length;e<t;++e)try{for(var i=this._pickTarget[e].getValue().getInnerNode(),n=i.getType(),s=n.length-1;s>=0;--s)switch(n[s]){case u().Inline:case u().Shape:case u().X3DGroupingNode:this.pickTargetNodes.add(i);break;default:continue}}catch{}},traverse(e,t){e===d().PICKING&&this.isPickableObject()&&this.modelMatrices.push(D.pop().assign(t.getModelViewMatrix().get()))},collect(e,t,i){var n=this.pickTargetNodes;if(i.some((e=>n.has(e)))){var s=this.targets;if(s.size<s.length)var o=s[s.size];else{o={modelMatrix:new(C()),pickingHierarchy:[],pickedPoint:[],intersections:[]};s.push(o)}++s.size,o.intersected=!1,o.geometryNode=e,o.pickedPoint.length=0,o.intersections.length=0,o.modelMatrix.assign(t);for(var r=o.pickingHierarchy,a=0,c=i.length;a<c;++a)r[a]=i[a];r.length=c}},process(){for(var e=this.modelMatrices,t=0,i=e.length;t<i;++t)D.push(e[t]);this.modelMatrices.length=0,this.targets.size=0}}),Object.defineProperties(E,{typeName:{value:"X3DPickSensorNode",enumerable:!0},componentName:{value:"Picking",enumerable:!0}});const I=E;y().add("X3DPickSensorNode","x_ite/Components/Picking/X3DPickSensorNode",I);const L=I,V=window[Symbol.for("X_ITE.X3D-8.12.0")].require("standard/Math/Numbers/Vector3");var z=e.n(V);const X=window[Symbol.for("X_ITE.X3D-8.12.0")].require("standard/Math/Geometry/Box3");var R=e.n(X);const q=window[Symbol.for("X_ITE.X3D-8.12.0")].require("standard/Math/Geometry/Line3");var Y,H,U,W,K,Q,Z,J,$,ee,te,ie,ne,se,oe,re,ae=e.n(q);function ce(e){L.call(this,e),this.addType(u().LinePickSensor),this.pickingGeometryNode=null}Object.assign(Object.setPrototypeOf(ce.prototype,L.prototype),{initialize(){L.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__(){this.pickingGeometryNode=null;try{for(var e=this._pickingGeometry.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case u().IndexedLineSet:case u().LineSet:this.pickingGeometryNode=e;break;default:continue}}catch{}},process:(Y=new(R()),H=new(R()),U=new(z())(0,0,0),W=new(z())(0,0,0),K=new(C()),Q=new(z())(0,0,0),Z=new(z())(0,0,0),J=new(ae())(z().Zero,z().zAxis),$=new(z())(0,0,0),ee=new(z())(0,0,0),te=[],ie=[],ne=new(z())(0,0,0),se=new(s().MFVec3f),oe=new(s().MFVec3f),re=new(s().MFVec3f),function(){if(this.pickingGeometryNode){var e=this.getModelMatrices(),t=this.getTargets();switch(this.getIntersectionType()){case f.BOUNDS:for(var i=0,n=e.length;i<n;++i){var s=e[i];Y.assign(this.pickingGeometryNode.getBBox()).multRight(s);for(var o=0,r=t.size;o<r;++o){var a=t[o];H.assign(a.geometryNode.getBBox()).multRight(a.modelMatrix),Y.intersectsBox(H)&&(U.assign(Y.center),W.assign(H.center),a.intersected=!0,a.distance=U.distance(W))}}var c=!!(y=this.getPickedGeometries()).length;y.assign(y.filter((e=>e))),c!==this._isActive.getValue()&&(this._isActive=c),this._pickedGeometry.equals(y)||(this._pickedGeometry=y);break;case f.GEOMETRY:for(i=0,n=e.length;i<n;++i)for(s=e[i],Y.assign(this.pickingGeometryNode.getBBox()).multRight(s),o=0,r=t.size;o<r;++o){var h=(a=t[o]).geometryNode,p=this.pickingGeometryNode.getVertices();H.assign(h.getBBox()).multRight(a.modelMatrix),K.assign(a.modelMatrix).inverse().multLeft(s);for(var l=0,d=p.length;l<d;l+=8)if(K.multVecMatrix(Q.set(p[l+0],p[l+1],p[l+2])),K.multVecMatrix(Z.set(p[l+4],p[l+5],p[l+6])),J.setPoints(Q,Z),ie.length=0,h.intersectsLine(J,a.modelMatrix,te,ie))for(var g=0,u=ie.length;g<u;++g){var m=ie[g];$.assign(m.point).subtract(Q),ee.assign(m.point).subtract(Z),$.add(ee).magnitude()<=Q.distance(Z)&&a.intersections.push(m)}a.intersections.length&&(U.assign(Y.center),W.assign(H.center),a.intersected=!0,a.distance=U.distance(W))}var y;c=!!(y=this.getPickedGeometries()).length,y.assign(y.filter((e=>e))),c!==this._isActive.getValue()&&(this._isActive=c),this._pickedGeometry.equals(y)||(this._pickedGeometry=y);var _=this.getPickedTargets();for(se.length=0,oe.length=0,re.length=0,o=0,r=_.length;o<r;++o){var w=_[o].intersections;for(g=0,u=w.length;g<u;++g)o=(m=w[g]).texCoord,ne.set(o.x,o.y,o.z),se.push(ne),oe.push(m.normal),re.push(m.point)}this._pickedTextureCoordinate.equals(se)||(this._pickedTextureCoordinate=se),this._pickedNormal.equals(oe)||(this._pickedNormal=oe),this._pickedPoint.equals(re)||(this._pickedPoint=re)}}L.prototype.process.call(this)})}),Object.defineProperties(ce,{typeName:{value:"LinePickSensor",enumerable:!0},componentName:{value:"Picking",enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze(["3.2","Infinity"]),enumerable:!0},fieldDefinitions:{value:new(c())([new(r())(u().inputOutput,"metadata",new(s().SFNode)),new(r())(u().inputOutput,"enabled",new(s().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(s().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(s().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(s().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(s().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(s().SFBool)),new(r())(u().outputOnly,"pickedTextureCoordinate",new(s().MFVec3f)),new(r())(u().outputOnly,"pickedNormal",new(s().MFVec3f)),new(r())(u().outputOnly,"pickedPoint",new(s().MFVec3f)),new(r())(u().inputOutput,"pickingGeometry",new(s().SFNode)),new(r())(u().inputOutput,"pickTarget",new(s().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(s().MFNode))]),enumerable:!0}});const he=ce;y().add("LinePickSensor","x_ite/Components/Picking/LinePickSensor",he);const pe=he,le=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Components/Grouping/X3DGroupingNode");var de=e.n(le);function ge(e){this.addType(u().X3DPickableObject),this.objectType=new Set}Object.assign(ge.prototype,{initialize(){this._objectType.addInterest("set_objectType__",this),this.set_objectType__()},getObjectType(){return this.objectType},set_objectType__(){this.objectType.clear();for(var e=0,t=this._objectType.length;e<t;++e)this.objectType.add(this._objectType[e])},dispose(){}}),Object.defineProperties(ge,{typeName:{value:"X3DPickableObject",enumerable:!0},componentName:{value:"Picking",enumerable:!0}});const ue=ge;y().add("X3DPickableObject","x_ite/Components/Picking/X3DPickableObject",ue);const me=ue;function ye(e){de().call(this,e),me.call(this,e),this.addType(u().PickableGroup)}Object.assign(Object.setPrototypeOf(ye.prototype,de().prototype),me.prototype,{initialize(){de().prototype.initialize.call(this),me.prototype.initialize.call(this),this._pickable.addInterest("set_pickable__",this),this.set_pickable__()},set_pickableObjects__(){this.set_pickable__()},set_pickable__(){this.setPickableObject(!(!this._pickable.getValue()&&!this.getTransformSensors().size))},traverse:(()=>{const e=new Set;return function(t,i){if(t===d().PICKING){if(this._pickable.getValue()){if(this.getObjectType().has("NONE"))return;const n=this.getBrowser(),s=n.getPickable();if(this.getObjectType().has("ALL"))s.push(!0),de().prototype.traverse.call(this,t,i),s.pop();else{const o=n.getPickSensors();for(const t of o.at(-1)){if(!t.getObjectType().has("ALL")){let e=0;for(const i of this.getObjectType())if(t.getObjectType().has(i)){++e;break}switch(t.getMatchCriterion()){case k.MATCH_ANY:if(0===e)continue;break;case k.MATCH_EVERY:if(e!==pickSensor.getObjectType().size)continue;break;case k.MATCH_ONLY_ONE:if(1!==e)continue}}e.add(t)}s.push(!0),o.push(e),de().prototype.traverse.call(this,t,i),o.pop(),s.pop(),e.clear()}}}else de().prototype.traverse.call(this,t,i)}})(),dispose(){me.prototype.dispose.call(this),de().prototype.dispose.call(this)}}),Object.defineProperties(ye,{typeName:{value:"PickableGroup",enumerable:!0},componentName:{value:"Picking",enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze(["3.2","Infinity"]),enumerable:!0},fieldDefinitions:{value:new(c())([new(r())(u().inputOutput,"metadata",new(s().SFNode)),new(r())(u().inputOutput,"pickable",new(s().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(s().MFString)("ALL")),new(r())(u().inputOutput,"visible",new(s().SFBool)(!0)),new(r())(u().inputOutput,"bboxDisplay",new(s().SFBool)),new(r())(u().initializeOnly,"bboxSize",new(s().SFVec3f)(-1,-1,-1)),new(r())(u().initializeOnly,"bboxCenter",new(s().SFVec3f)),new(r())(u().inputOnly,"addChildren",new(s().MFNode)),new(r())(u().inputOnly,"removeChildren",new(s().MFNode)),new(r())(u().inputOutput,"children",new(s().MFNode))]),enumerable:!0}});const _e=ye;y().add("PickableGroup","x_ite/Components/Picking/PickableGroup",_e);const we=_e,ke=window[Symbol.for("X_ITE.X3D-8.12.0")].require("x_ite/Base/X3DCast");var Se=e.n(ke);const be=window[Symbol.for("X_ITE.X3D-8.12.0")].require("standard/Math/Numbers/Rotation4");var fe=e.n(be);const ve=window[Symbol.for("X_ITE.X3D-8.12.0")].require("lib/ammojs/AmmoClass");var Oe=e.n(ve);function Te(){this.broadphase=new(Oe().btDbvtBroadphase),this.collisionConfiguration=new(Oe().btDefaultCollisionConfiguration),this.dispatcher=new(Oe().btCollisionDispatcher)(this.collisionConfiguration),this.collisionWorld=new(Oe().btCollisionWorld)(this.dispatcher,this.broadphase,this.collisionConfiguration),this.compoundShape1=new(Oe().btCompoundShape),this.motionState1=new(Oe().btDefaultMotionState),this.constructionInfo1=new(Oe().btRigidBodyConstructionInfo)(0,this.motionState1,this.compoundShape1),this.rigidBody1=new(Oe().btRigidBody)(this.constructionInfo1),this.compoundShape2=new(Oe().btCompoundShape),this.motionState2=new(Oe().btDefaultMotionState),this.constructionInfo2=new(Oe().btRigidBodyConstructionInfo)(0,this.motionState2,this.compoundShape2),this.rigidBody2=new(Oe().btRigidBody)(this.constructionInfo2),this.collisionWorld.addCollisionObject(this.rigidBody1),this.collisionWorld.addCollisionObject(this.rigidBody2)}Object.assign(Te.prototype,{constuctor:Te,setChildShape1(e,t){this.setChildShape(this.compoundShape1,e,t)},setChildShape2(e,t){this.setChildShape(this.compoundShape2,e,t)},setChildShape1Components(e,t,i){this.setChildShapeComponents(this.compoundShape1,e,t,i)},setChildShape2Components(e,t,i){this.setChildShapeComponents(this.compoundShape2,e,t,i)},setChildShape:(()=>{const e=new(z())(0,0,0),t=new(fe()),i=new(z())(1,1,1),n=new(Oe().btVector3)(0,0,0);return function(s,o,r){s.getNumChildShapes()&&s.removeChildShapeByIndex(0),r.getNumChildShapes()&&(o.get(e,t,i),n.setValue(i.x,i.y,i.z),r.setLocalScaling(n),s.addChildShape(this.getTransform(e,t),r))}})(),setChildShapeComponents(e,t,i,n){e.getNumChildShapes()&&e.removeChildShapeByIndex(0),n.getNumChildShapes()&&(n.setLocalScaling(i),e.addChildShape(t,n))},contactTest(){this.collisionWorld.performDiscreteCollisionDetection();const e=this.dispatcher.getNumManifolds();for(let t=0;t<e;++t){const e=this.dispatcher.getManifoldByIndexInternal(t),i=e.getNumContacts();for(let t=0;t<i;++t){if(e.getContactPoint(t).getDistance()<=0)return!0}}return!1},getTransform:(()=>{const e=new(Oe().btTransform),t=new(Oe().btVector3)(0,0,0),i=new(C());return function(n,s,o){const r=o||e;return i.set(n,s),t.setValue(i[12],i[13],i[14]),r.getBasis().setValue(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),r.setOrigin(t),r}})()});const Ne=Te;y().add("VolumePicker","x_ite/Browser/Picking/VolumePicker",Ne);const Ce=Ne;function Pe(e){L.call(this,e),this.addType(u().PointPickSensor),this.pickingGeometryNode=null,this.picker=new Ce,this.compoundShapes=[]}var Ge,Me,xe;Object.assign(Object.setPrototypeOf(Pe.prototype,L.prototype),{initialize(){L.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__(){this.pickingGeometryNode&&this.pickingGeometryNode._rebuild.removeInterest("set_geometry__",this),this.pickingGeometryNode=Se()(u().PointSet,this._pickingGeometry),this.pickingGeometryNode&&this.pickingGeometryNode._rebuild.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:(Ge=new(Oe().btVector3)(1,1,1),Me=new(Oe().btVector3),xe=new(Oe().btTransform),function(){var e=this.compoundShapes;if(this.pickingGeometryNode){var t=this.pickingGeometryNode.getCoord();if(t){for(var i=0,n=t.getSize();i<n;++i)if(i<e.length){var s=e[i],o=t.get1Point(i,s.point);Me.setValue(o.x,o.y,o.z),xe.setOrigin(Me),s.setLocalScaling(Ge),s.updateChildTransform(0,xe)}else{s=new(Oe().btCompoundShape);var r=new(Oe().btSphereShape)(0);o=t.get1Point(i,new(z())(0,0,0)),s.point=o,Me.setValue(o.x,o.y,o.z),xe.setOrigin(Me),s.addChildShape(xe,r),e.push(s)}e.length=n}else e.length=0}else e.length=0}),process:(()=>{var e=new(R()),t=new(R()),i=new(z())(0,0,0),n=new(z())(0,0,0),o=new(Oe().btTransform),r=new(Oe().btVector3),a=new(z())(0,0,0),c=new(fe()),h=new(z())(1,1,1),p=new(s().MFVec3f);return function(){if(this.pickingGeometryNode){var s=this.getModelMatrices(),l=this.getTargets();switch(this.getIntersectionType()){case f.BOUNDS:for(var d=0,g=s.length;d<g;++d){var u=s[d];e.assign(this.pickingGeometryNode.getBBox()).multRight(u);for(var m=0,y=l.size;m<y;++m){var _=l[m];t.assign(_.geometryNode.getBBox()).multRight(_.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),n.assign(t.center),_.intersected=!0,_.distance=i.distance(n))}}var w=!!(N=this.getPickedGeometries()).length;N.assign(N.filter((e=>e))),w!==this._isActive.getValue()&&(this._isActive=w),this._pickedGeometry.equals(N)||(this._pickedGeometry=N);break;case f.GEOMETRY:var k=this.picker,S=this.compoundShapes;for(d=0,g=s.length;d<g;++d){u=s[d];e.assign(this.pickingGeometryNode.getBBox()).multRight(u),u.get(a,c,h),k.getTransform(a,c,o),r.setValue(h.x,h.y,h.z);for(var b=0,v=S.length;b<v;++b){var O=S[b];k.setChildShape1Components(o,r,O);for(m=0,y=l.size;m<y;++m){_=l[m];var T=this.getPickShape(_.geometryNode);t.assign(_.geometryNode.getBBox()).multRight(_.modelMatrix),k.setChildShape2(_.modelMatrix,T.getCompoundShape()),k.contactTest()&&(i.assign(e.center),n.assign(t.center),_.intersected=!0,_.distance=i.distance(n),_.pickedPoint.push(O.point))}}}var N;w=!!(N=this.getPickedGeometries()).length;N.assign(N.filter((e=>e))),w!==this._isActive.getValue()&&(this._isActive=w),this._pickedGeometry.equals(N)||(this._pickedGeometry=N);var C=this.getPickedTargets();p.length=0;for(m=0,y=C.length;m<y;++m)for(var P=C[m].pickedPoint,G=0,M=P.length;G<M;++G)p.push(P[G]);this._pickedPoint.equals(p)||(this._pickedPoint=p)}}L.prototype.process.call(this)}})()}),Object.defineProperties(Pe,{typeName:{value:"PointPickSensor",enumerable:!0},componentName:{value:"Picking",enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze(["3.2","Infinity"]),enumerable:!0},fieldDefinitions:{value:new(c())([new(r())(u().inputOutput,"metadata",new(s().SFNode)),new(r())(u().inputOutput,"enabled",new(s().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(s().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(s().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(s().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(s().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(s().SFBool)),new(r())(u().outputOnly,"pickedPoint",new(s().MFVec3f)),new(r())(u().inputOutput,"pickingGeometry",new(s().SFNode)),new(r())(u().inputOutput,"pickTarget",new(s().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(s().MFNode))]),enumerable:!0}});const Be=Pe;y().add("PointPickSensor","x_ite/Components/Picking/PointPickSensor",Be);const je=Be;function Ae(e){L.call(this,e),this.addType(u().PrimitivePickSensor),this.pickingGeometryNode=null,this.picker=new Ce}Object.assign(Object.setPrototypeOf(Ae.prototype,L.prototype),{initialize(){L.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__(){this.pickingGeometryNode=null;try{for(var e=this._pickingGeometry.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case u().Box:case u().Cone:case u().Cylinder:case u().Sphere:this.pickingGeometryNode=e;break;default:continue}}catch{}},process:(()=>{var e=new(R()),t=new(R()),i=new(z())(0,0,0),n=new(z())(0,0,0);return function(){if(this.pickingGeometryNode){var s=this.getModelMatrices(),o=this.getTargets();switch(this.getIntersectionType()){case f.BOUNDS:for(var r=0,a=s.length;r<a;++r){var c=s[r];e.assign(this.pickingGeometryNode.getBBox()).multRight(c);for(var h=0,p=o.size;h<p;++h){var l=o[h];t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}var d=!!(y=this.getPickedGeometries()).length;y.assign(y.filter((e=>e))),d!==this._isActive.getValue()&&(this._isActive=d),this._pickedGeometry.equals(y)||(this._pickedGeometry=y);break;case f.GEOMETRY:var g=this.picker;for(r=0,a=s.length;r<a;++r){c=s[r];var u=this.getPickShape(this.pickingGeometryNode);e.assign(this.pickingGeometryNode.getBBox()).multRight(c),g.setChildShape1(c,u.getCompoundShape());for(h=0,p=o.size;h<p;++h){l=o[h];var m=this.getPickShape(l.geometryNode);t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),g.setChildShape2(l.modelMatrix,m.getCompoundShape()),g.contactTest()&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}var y;d=!!(y=this.getPickedGeometries()).length;y.assign(y.filter((e=>e))),d!==this._isActive.getValue()&&(this._isActive=d),this._pickedGeometry.equals(y)||(this._pickedGeometry=y)}}L.prototype.process.call(this)}})()}),Object.defineProperties(Ae,{typeName:{value:"PrimitivePickSensor",enumerable:!0},componentName:{value:"Picking",enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze(["3.2","Infinity"]),enumerable:!0},fieldDefinitions:{value:new(c())([new(r())(u().inputOutput,"metadata",new(s().SFNode)),new(r())(u().inputOutput,"enabled",new(s().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(s().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(s().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(s().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(s().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(s().SFBool)),new(r())(u().inputOutput,"pickingGeometry",new(s().SFNode)),new(r())(u().inputOutput,"pickTarget",new(s().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(s().MFNode))]),enumerable:!0}});const De=Ae;y().add("PrimitivePickSensor","x_ite/Components/Picking/PrimitivePickSensor",De);const Fe=De;function Ee(e){L.call(this,e),this.addType(u().VolumePickSensor),this.pickingGeometryNode=null,this.picker=new Ce}Object.assign(Object.setPrototypeOf(Ee.prototype,L.prototype),{initialize(){L.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__(){this.pickingGeometryNode=Se()(u().X3DGeometryNode,this._pickingGeometry)},process:(()=>{var e=new(R()),t=new(R()),i=new(z())(0,0,0),n=new(z())(0,0,0);return function(){if(this.pickingGeometryNode){var s=this.getModelMatrices(),o=this.getTargets();switch(this.getIntersectionType()){case f.BOUNDS:for(var r=0,a=s.length;r<a;++r){var c=s[r];e.assign(this.pickingGeometryNode.getBBox()).multRight(c);for(var h=0,p=o.size;h<p;++h){var l=o[h];t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}var d=!!(y=this.getPickedGeometries()).length;y.assign(y.filter((e=>e))),d!==this._isActive.getValue()&&(this._isActive=d),this._pickedGeometry.equals(y)||(this._pickedGeometry=y);break;case f.GEOMETRY:var g=this.picker;for(r=0,a=s.length;r<a;++r){c=s[r];var u=this.getPickShape(this.pickingGeometryNode);e.assign(this.pickingGeometryNode.getBBox()).multRight(c),g.setChildShape1(c,u.getCompoundShape());for(h=0,p=o.size;h<p;++h){l=o[h];var m=this.getPickShape(l.geometryNode);t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),g.setChildShape2(l.modelMatrix,m.getCompoundShape()),g.contactTest()&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}var y;d=!!(y=this.getPickedGeometries()).length;y.assign(y.filter((e=>e))),d!==this._isActive.getValue()&&(this._isActive=d),this._pickedGeometry.equals(y)||(this._pickedGeometry=y)}}L.prototype.process.call(this)}})()}),Object.defineProperties(Ee,{typeName:{value:"VolumePickSensor",enumerable:!0},componentName:{value:"Picking",enumerable:!0},containerField:{value:"children",enumerable:!0},specificationRange:{value:Object.freeze(["3.2","Infinity"]),enumerable:!0},fieldDefinitions:{value:new(c())([new(r())(u().inputOutput,"metadata",new(s().SFNode)),new(r())(u().inputOutput,"enabled",new(s().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(s().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(s().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(s().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(s().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(s().SFBool)),new(r())(u().inputOutput,"pickingGeometry",new(s().SFNode)),new(r())(u().inputOutput,"pickTarget",new(s().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(s().MFNode))]),enumerable:!0}});const Ie=Ee;y().add("VolumePickSensor","x_ite/Components/Picking/VolumePickSensor",Ie);const Le=Ie;i().add({name:"Picking",concreteNodes:[pe,we,je,Fe,Le],abstractNodes:[L,me]});const Ve=void 0;y().add("Picking","assets/components/Picking",Ve)})();